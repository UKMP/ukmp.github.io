<!DOCTYPE html>
<html lang="{{ $.Site.Language.Lang }}">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>
            {{- if .IsHome -}}
                {{ $.Site.Title }} chat &amp; conferencing
            {{- else -}}
                {{ $.Site.Title }} - {{ .Title }}
            {{- end -}}
        </title>
        
        {{- $description := "" -}}
        {{- if .IsHome -}}
            {{- $description = "Pearrd is a chat and conferencing platform with no sign up." -}}
        {{- else if (isset .Params "description") -}}
            {{- $description = .Param "description" -}}
        {{- end -}}
    
        {{ if ne $description "" }}
        <meta name="description" content="{{ $description }}">
        {{- end }}

        <!-- Process CSS files with PostCSS -->
        <!-- More details: https://gohugo.io/hugo-pipes/postcss/ -->
        {{ $style := resources.Get "css/main.css" | resources.PostCSS }}
        <link rel="stylesheet" href="{{ $style.RelPermalink }}">

        <!-- Process JavaScript files with ESBuild -->
        <!-- More details: https://gohugo.io/hugo-pipes/js/ -->
        {{ $built := resources.Get "js/index.js" | js.Build "js/main.js" }}
        <script src="{{ $built.RelPermalink }}" defer></script>

        {{ block "page-head" . }}{{ end }}

        {{- if eq hugo.Environment "production" -}}
            {{ partial "umami" . }}
        {{- end }}
    </head>

    <body class="dark-mode">
        {{ block "modals" . }}{{ end }}

        <div class="page-wrapper with-navbar">
            {{- block "nav" . }}
            <nav class="navbar">
                <a href="{{ `` | relURL }}" class="navbar-brand">
                    <img src="{{ `img/pearrd-logo.svg` | relURL }}" alt="Pearrd logo" width="50" height="50">
                    Pearrd
                </a>
                
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a href="{{ `` | relURL }}" class="nav-link">Home</a>
                    </li>

                    {{- $navpages := where .Site.Pages.ByWeight "Title" "!=" $.Site.Title }}
                    {{ range $navpages }}
                        <li class="nav-item">
                            <a href="{{ .RelPermalink }}" class="nav-link">{{ .Title }}</a>
                        </li>
                    {{- end }}
                </ul>
            </nav>
            {{- end }}

            <div class="sticky-alerts"></div>

            <div class="content-wrapper">
                {{ block "header" . }}{{ partial "header" . }}{{ end }}

                {{- block "main" . }}
                    <main>{{- block "main-content" . }}{{ end -}}</main>
                {{- end }}

                {{ block "footer" . }}{{ partial "footer" . }}{{ end }}
            </div>
        </div>
    </body>
</html>